---
import Layout from '../layouts/Layout.astro';
import { getCollection } from 'astro:content';

const blogPosts = await getCollection('blog');
const sortedPosts = blogPosts.sort((a, b) => new Date(b.data.date).getTime() - new Date(a.data.date).getTime());
---

<Layout title="Blog - Mark Wylde" currentPage="blog">
	<section class="section">
		<div class="container">
			<h2>Blog</h2>
			<p style="text-align: center; margin-bottom: 3rem;">
				Thoughts on web development, simplicity, and building things that work
			</p>

			<div class="blog-grid">
				{sortedPosts.map((post) => (
					<article class="blog-card">
						<h3 class="blog-title">
							<a href={`/blog/${post.slug}`}>{post.data.title}</a>
						</h3>
						<div class="blog-meta">
							<time datetime={post.data.date}>{new Date(post.data.date).toLocaleDateString('en-US', {
								year: 'numeric',
								month: 'long',
								day: 'numeric'
							})}</time>
						</div>
						<p class="blog-excerpt">{post.data.excerpt}</p>
						<a href={`/blog/${post.slug}`} class="read-more">Read More â†’</a>
						<div class="blog-tags">
							{post.data.tags.map((tag) => (
								<span class="tag">{tag}</span>
							))}
						</div>
					</article>
				))}
			</div>

		</div>
	</section>
</Layout>

<style>
	.blog-grid {
		display: grid;
		grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
		gap: 30px;
		margin-bottom: 3rem;
		align-items: stretch;
	}

	.blog-card {
		background-color: var(--secondary-bg);
		padding: 25px;
		border-radius: 8px;
		box-shadow: 0 5px 15px var(--shadow-color);
		transition: transform 0.3s ease, box-shadow 0.3s ease;
		border: 1px solid var(--border-color);
		display: flex;
		flex-direction: column;
		height: 100%;
	}

	.blog-card:hover {
		box-shadow: 0 8px 20px rgba(0, 0, 0, 0.08);
	}

	.blog-meta {
		margin-bottom: 15px;
	}

	.blog-tags {
		overflow-x: auto;
		white-space: nowrap;
		margin-top: auto;
		padding-bottom: 2px;
		scrollbar-width: thin;
		scrollbar-color: var(--accent-color) transparent;
	}

	.blog-tags::-webkit-scrollbar {
		height: 4px;
	}

	.blog-tags::-webkit-scrollbar-track {
		background: transparent;
	}

	.blog-tags::-webkit-scrollbar-thumb {
		background-color: var(--accent-color);
		border-radius: 2px;
	}

	.tag {
		flex-shrink: 0;
	}

	.blog-title {
		margin-bottom: 15px;
		order: -1;
	}

	.blog-title a {
		color: var(--heading-color);
		text-decoration: none;
	}

	.blog-title a:hover {
		color: var(--accent-color);
	}

	.blog-excerpt {
		margin-bottom: 15px;
		line-height: 1.6;
		flex-grow: 1;
	}

	.read-more {
		color: var(--accent-color);
		text-decoration: none;
		font-weight: 500;
		transition: color 0.3s ease;
		margin-bottom: 15px;
	}

	.read-more:hover {
		color: var(--heading-color);
	}

</style>
